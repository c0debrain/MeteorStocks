<head>
<title>Meteor Stocks</title>
<link rel="icon" type="image/png" href="/favicon.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- JB Dec 2014 - Added to make Bootstrap work on Android Chrome -->
<!-- 3 Dec 14 - using the package instead: meteor add mizzao:bootstrap-3
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>-->
</head>
<body>
    <!--glyphicons: http://getbootstrap.com/components -->
    <div class="container">     
    <!-- Static navbar -->
      <div class="navbar navbar-default navbar-inverse" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span> <!-- 3 bar graphic for menus on mobile -->
            </button>
          <a class="navbar-brand" href="#">Meteor Stocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="#"><span class="badge"><button class="refresh">Refresh <span class="glyphicon glyphicon-refresh"></span></button></span></a></li>
            <li><a href="#"><span class="badge"><button class="location">Location <span class="glyphicon glyphicon-signal"></span></button></span></a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">More... <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="#">Services <span class="glyphicon glyphicon-paperclip"></span></a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Details</li>
                <li><a href="#"><button class="camera">About Us <span class="glyphicon glyphicon-info-sign"></span></button></a></li>
                <li><a href="#"><button class="camera">Camera <span class="glyphicon glyphicon-camera"></span></button></a></li>
                <li class="divider"></li>
                <li><a href="#">Help <span class="glyphicon glyphicon-question-sign"></span></a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div><!-- container-fluid -->
    </div><!-- navbar -->
  </div> <!-- container -->
      
<div class="container">
<header>
<!--<h1>Stock Monitor</h1>-->Bootstrap 3 with dropdowns, glyphicons and action button. Colour change on values. Async (via callback) remote server calls with CSV parsing.
Delete, single Update and Refresh enabled. Cordovo included for vibration feedback and GPS location. Camera works now too. Dividends shown.
NEW Heatmap - now with Tooltips. Supports all markets eg IBM.US or TSCO.L - and has better input checking.
<br><br>  
<form class="new-stock">
  <input type="text" name="text" placeholder="Stock to add" />
</form>
</header>

<!--<p id="GPS"></p> this was the pre-template way of doing it -->

{{GPSLocation}}<br>

<!--<br>Table based Heatmap - does not work correctly in Chrome<br>
<table style="max-width: 95%; font-size: 1px; font-family: monospace">{{#each stocks}}{{> heatmap}}
{{/each}}</table>
-->

<!-- None-table based Heatmap works in Firefox and Chrome. font-size of 1px is used to ensure minimal gaps - padding etc don't work -->
<span style="max-width: 95%; font-size: 1px; font-family: monospace">
{{#each stocks}}{{> heatmap}}
{{/each}} <!-- auto-wrap breaks if this on the same line as above - whoa! -->
<br>
</span>

<table class="table table-striped">
  <thead><tr><th style="text-align:left"><button class="sortStocks">{{StockDir}}</button></th><th>Price</th><th>Change</th><th><button class="sortChange">{{ChangeDir}}</button></th><th></th><th></th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr></thead>
  <tbody>
  {{#each stocks}}
  {{> stock}}
  {{/each}}
  </tbody>
</table>

<IMG width=50% SRC="http://www.asx.com.au/asx/widget/chart.do?asxCode=XJO&type=INDEX" alt="<XJO Chart>"/><br><br>

<IMG width=50% SRC="https://chart.finance.yahoo.com/z?s=^DJI&t=1d" alt="<Dow Chart>"/><br>

<IMG width=50% SRC="https://chart.finance.yahoo.com/t?s=AUDUSD=X" alt="<Gold Chart>"/><br><br>

<img id="CordovaImage" width='90%' height='90%'/> <!-- Any photo goes here scaled to fit -->

<div class="footer">
<p>&copy; 2014 Jon Brown - version 16 Jan 2015<br>Meteor 1.0.2 / Xubuntu 14.04 / Acer C720</p>
</div>
{{getDateClass XDiv}}
</div>
</body>

<!-- ========== METEOR TEMPLATE CODE ========== -->

<template name="heatmap">
<!--<span class="{{getHeatColour chgPC}}">&nbsp;{{code}}&nbsp;</span>-->
<a href="#" class="xtooltip" id="{{getHeatColourStyle chgPC}}">&nbsp;{{code}}&nbsp;<span><img class="xcallout"
/><strong><center>{{last}}</center></strong><center>{{chgPC}}%</center></span></a></template>

<!-- This Bootstrap tooltip line works on it's own but not inside a Meteor Template
<a href="#" data-toggle="tooltip" data-placement="top" data-original-title="$75.63 +0.3%">CBA</a>
-->

<template name="stock">
  <tr>
  <td style="text-align:left"><button class="update">{{code}}</button></td> <!-- 12 Dec 2014 - added ability to update by clicking the stock code -->
  <td>{{last}}</td>
  <td><span class="{{getSignColour chg}}">{{chg}}</span></td>
  <td><span class="{{getSignClass chgPC}}">{{chgPC}}</span></td>
  <td><!--<button class="update"><span class="glyphicon glyphicon-repeat"></span></button> UNUSED --></td> <!-- Added an update option 3 Dec 2014, added glyph 12 Dec 2014 -->
  <td><button class="delete"><span class="glyphicon glyphicon-remove"></span></button></td> <!-- Added a delete option 3 Dec 2014, added glyph 12 Dec 2014 instead of &times; -->
<!-- Unused technique:
<td><span class="unchanged" style="color:{{getSignColour chg}}">{{chg}}</span></td> -->
<td><span class="">{{dXDiv}}</span></td><!-- 18 Dec 2014 - added dividend details -->
<td><span class="{{getDateClass Paid}}">{{dPaid}}</span></td>
<td>{{Franked}}</td>
<td>{{Percent}}</td>
  </tr>
</template>
